<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symbol of Alberta Memory Matching Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti library for celebration effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #22162b; /* Very dark purple */
        }
        .container {
            max-width: 900px;
        }
        #game-board {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1.5rem;
        }
        .card {
            background-color: transparent;
            height: 250px;
            perspective: 1000px;
            cursor: pointer;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 1rem;
            overflow: hidden;
        }
        .card-front {
            background-color: #451f55; /* Darker purple */
            color: #e54f6d; /* Red */
        }
        .card-back {
            background-color: white;
            color: #22162b;
            transform: rotateY(180deg);
        }
        .card-back img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
            border-radius: 1.5rem;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .card-back .card-text {
            display: none;
            position: relative;
            z-index: 10;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-top: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .matched .card-back .card-text {
            display: block;
        }
        /* Haptic shake effect for incorrect matches */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        /* Style for player turn highlighting */
        #player1-score, #player2-score {
            transition: all 0.3s ease-in-out;
            padding: 0.5rem 1rem;
            border-radius: 1rem;
        }
        .active-player {
            background-color: rgba(248, 198, 48, 0.2); /* A faint yellow glow */
            box-shadow: 0 0 15px rgba(248, 198, 48, 0.5);
            transform: scale(1.05);
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="container mx-auto">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-center text-[#e54f6d] mb-4">
            Symbol of Alberta Memory Matching Game
        </h1>
        <p class="text-center text-[#f8c630] mb-6 max-w-2xl mx-auto">
            Match the image of a symbol to its description. Find all the pairs to win!
        </p>

        <!-- Game mode, size, and restart controls -->
        <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-4">
            <div class="flex items-center gap-2">
                <label for="game-mode-selector" class="text-white font-bold text-lg">Mode:</label>
                <select id="game-mode-selector" class="bg-white text-[#22162b] p-2 rounded-lg">
                    <option value="1">1 Player</option>
                    <option value="2">2 Players</option>
                </select>
            </div>
            <div class="flex items-center gap-2">
                <label for="game-size-selector" class="text-white font-bold text-lg">Size:</label>
                <select id="game-size-selector" class="bg-white text-[#22162b] p-2 rounded-lg">
                    <option value="6">Small (6 pairs)</option>
                    <option value="12">Full (12 pairs)</option>
                </select>
            </div>
            <button id="restart-button" class="bg-[#e54f6d] text-white font-bold py-2 px-6 rounded-full hover:bg-[#c2435e] transition-colors duration-300">
                Start New Game
            </button>
        </div>

        <!-- Scoreboard for 2-player mode -->
        <div id="scoreboard" class="hidden flex justify-around items-center text-center text-white mb-8 gap-4">
            <div id="player1-score" class="flex flex-col items-center">
                <h2 class="text-xl font-bold">Player 1</h2>
                <p class="text-3xl font-bold text-[#f8c630]">0</p>
            </div>
            <div id="player2-score" class="flex flex-col items-center">
                <h2 class="text-xl font-bold">Player 2</h2>
                <p class="text-3xl font-bold text-[#f8c630]">0</p>
            </div>
        </div>

        <div id="game-board" class="mb-8"></div>
        <div id="status" class="text-center text-xl font-bold text-[#724e91] mt-8"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const allSymbols = [
                {
                    id: 'arms',
                    image: "https://upload.wikimedia.org/wikipedia/commons/a/ab/Coat_of_arms_of_Alberta.svg",
                    title: "Coat of Arms",
                    description: "The Coat of Arms of Alberta features a St. George's Cross and a landscape with mountains, hills, and a wheat field. Its motto is 'Fortis et Liber,' meaning 'Strong and Free'."
                },
                {
                    id: 'flag',
                    image: "https://upload.wikimedia.org/wikipedia/commons/f/f5/Flag_of_Alberta.svg",
                    title: "Flag of Alberta",
                    description: "Adopted on June 1, 1968, the flag features the provincial shield centered on an ultramarine blue background."
                },
                {
                    id: 'rose',
                    image: "https://upload.wikimedia.org/wikipedia/commons/1/18/Wild_rose_flower.jpg",
                    title: "Wild Rose",
                    description: "The Wild Rose (Rosa acicularis) was designated the floral emblem in 1930. It is a common flower found throughout the province."
                },
                {
                    id: 'fescue',
                    image: "https://upload.wikimedia.org/wikipedia/commons/8/8a/Lolium-pratense1web.jpg",
                    title: "Rough Fescue",
                    description: "Rough Fescue (Festuca scabrella) was adopted as Alberta's official grass in 2003. It's a vital part of the province's prairie heritage."
                },
                {
                    id: 'owl',
                    image: "https://upload.wikimedia.org/wikipedia/commons/9/98/GreatHornedOwl-Wiki.jpg",
                    title: "Great Horned Owl",
                    description: "Chosen by a province-wide children's vote in 1977, the Great Horned Owl (Bubo virginianus) is the official bird of Alberta."
                },
                {
                    id: 'sheep',
                    image: "https://upload.wikimedia.org/wikipedia/commons/3/30/DWBighornsheep.jpg",
                    title: "Bighorn Sheep",
                    description: "The Bighorn Sheep (Ovis canadensis) is Alberta's provincial mammal. These majestic animals are a common sight in the Rocky Mountains."
                },
                {
                    id: 'tartan',
                    image: "https://upload.wikimedia.org/wikipedia/commons/7/7d/Tartan_of_Alberta.png",
                    title: "Alberta Tartan",
                    description: "The Alberta tartan was designed in 1961 and features colors that represent the province's forests, wheat fields, skies, and wild roses."
                },
                {
                    id: 'dresstartan',
                    image: "https://upload.wikimedia.org/wikipedia/commons/e/e3/Alberta_Dress_Tartan.jpg",
                    title: "Alberta Dress Tartan",
                    description: "Adopted in 2000, the Alberta dress tartan is a complementary version of the Alberta tartan, adding large sections of white."
                },
                {
                    id: 'pine',
                    image: "https://upload.wikimedia.org/wikipedia/commons/e/ea/LodgepolePine_6915.jpg",
                    title: "Lodgepole Pine",
                    description: "The Lodgepole Pine (Pinus contorta) was adopted as the official tree in 1984. It is a significant part of Alberta's history."
                },
                {
                    id: 'wood',
                    image: "https://upload.wikimedia.org/wikipedia/commons/f/f3/PetrifiedWood.jpg",
                    title: "Petrified Wood",
                    description: "Petrified Wood was named Alberta's official stone in 1977. It is a fossilized remnant of ancient forests found in the province."
                },
                {
                    id: 'ammolite',
                    image: "https://upload.wikimedia.org/wikipedia/commons/2/2a/Ammolite.jpg",
                    title: "Ammolite",
                    description: "Ammolite is Alberta's official gemstone. This iridescent gemstone is made from the fossilized shells of ammonites."
                },
                {
                    id: 'mace',
                    image: "https://upload.wikimedia.org/wikipedia/commons/b/b0/The_Mace_of_Alberta.jpg",
                    title: "Mace of Alberta",
                    description: "The Mace of Alberta symbolizes the authority of the Speaker and the Legislative Assembly."
                }
            ];

            const gameBoard = document.getElementById('game-board');
            const statusDiv = document.getElementById('status');
            const restartButton = document.getElementById('restart-button');
            const sizeSelector = document.getElementById('game-size-selector');
            const modeSelector = document.getElementById('game-mode-selector');
            const scoreboard = document.getElementById('scoreboard');
            const player1ScoreEl = document.getElementById('player1-score').querySelector('p');
            const player2ScoreEl = document.getElementById('player2-score').querySelector('p');
            const player1Div = document.getElementById('player1-score');
            const player2Div = document.getElementById('player2-score');
            
            let hasFlippedCard = false;
            let lockBoard = false;
            let firstCard, secondCard;
            let matchesFound = 0;
            let currentSymbolSet = [];
            let gameMode = 1;
            let currentPlayer = 1;
            let player1Score = 0;
            let player2Score = 0;
            const apiKey = "";

            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function createCards() {
                gameBoard.innerHTML = '';
                matchesFound = 0;
                player1Score = 0;
                player2Score = 0;
                currentPlayer = 1;
                updateStatus();

                const cardData = currentSymbolSet.flatMap(symbol => [
                    { id: symbol.id, type: 'image', content: symbol.image, title: symbol.title, description: '' },
                    { id: symbol.id, type: 'text', content: symbol.description, title: symbol.title, description: symbol.description }
                ]);

                shuffle(cardData);

                cardData.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.classList.add('card');
                    cardElement.dataset.id = card.id;
                    cardElement.dataset.type = card.type;
                    cardElement.dataset.title = card.title;

                    const innerHTML = `
                        <div class="card-inner">
                            <div class="card-front">
                                <span class="text-3xl font-bold text-[#f8c630]">?</span>
                            </div>
                            <div class="card-back">
                                ${card.type === 'image' ? `<img src="${card.content}" alt="${card.title}">` : ''}
                                <div class="p-2 w-full text-center">
                                    <h2 class="text-xl font-bold mb-2 text-[#e54f6d]">${card.title}</h2>
                                    ${card.type === 'text' ? `<p class="text-sm card-text leading-tight text-gray-700">${card.description}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                    cardElement.innerHTML = innerHTML;
                    gameBoard.appendChild(cardElement);

                    cardElement.addEventListener('click', flipCard);
                });
            }

            function updateStatus() {
                if (gameMode === 2) {
                    scoreboard.classList.remove('hidden');
                    scoreboard.classList.add('flex');
                    player1ScoreEl.textContent = player1Score;
                    player2ScoreEl.textContent = player2Score;
                    statusDiv.textContent = `Player ${currentPlayer}'s turn!`;

                    if (currentPlayer === 1) {
                        player1Div.classList.add('active-player');
                        player2Div.classList.remove('active-player');
                    } else {
                        player2Div.classList.add('active-player');
                        player1Div.classList.remove('active-player');
                    }
                } else {
                    scoreboard.classList.add('hidden');
                    scoreboard.classList.remove('flex');
                    player1Div.classList.remove('active-player');
                    player2Div.classList.remove('active-player');
                    statusDiv.textContent = '';
                }
            }

            function flipCard() {
                if (lockBoard) return;
                if (this === firstCard) return;

                this.classList.add('is-flipped');
                
                if (!hasFlippedCard) {
                    hasFlippedCard = true;
                    firstCard = this;
                    return;
                }

                secondCard = this;
                checkForMatch();
            }

            function checkForMatch() {
                const isMatch = firstCard.dataset.id === secondCard.dataset.id;
                
                if (isMatch) {
                    disableCards();
                } else {
                    unflipCards();
                }
            }

            function disableCards() {
                firstCard.removeEventListener('click', flipCard);
                secondCard.removeEventListener('click', flipCard);
                
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                
                matchesFound++;
                if (gameMode === 2) {
                    if (currentPlayer === 1) {
                        player1Score++;
                    } else {
                        player2Score++;
                    }
                }
                updateStatus();

                if (matchesFound === currentSymbolSet.length) {
                    if (gameMode === 2) {
                        if (player1Score > player2Score) {
                            statusDiv.textContent = `Player 1 wins with ${player1Score} matches!`;
                        } else if (player2Score > player1Score) {
                            statusDiv.textContent = `Player 2 wins with ${player2Score} matches!`;
                        } else {
                            statusDiv.textContent = `It's a tie! Both players got ${player1Score} matches.`;
                        }
                    } else {
                        statusDiv.textContent = "Congratulations! You've matched all the symbols!";
                    }
                    triggerCelebration();
                }

                resetBoard(false); // Do not switch players on a match
            }

            function unflipCards() {
                lockBoard = true;
                setTimeout(() => {
                    firstCard.classList.add('shake');
                    secondCard.classList.add('shake');
                    setTimeout(() => {
                        firstCard.classList.remove('shake');
                        secondCard.classList.remove('shake');
                        firstCard.classList.remove('is-flipped');
                        secondCard.classList.remove('is-flipped');
                        resetBoard(true);
                    }, 500); // Duration of the shake animation
                }, 1000); // Delay before the shake starts, so cards stay flipped for a moment
            }

            function resetBoard(switchPlayer = false) {
                [hasFlippedCard, lockBoard] = [false, false];
                [firstCard, secondCard] = [null, null];
                if (gameMode === 2 && switchPlayer) {
                    currentPlayer = currentPlayer === 1 ? 2 : 1;
                    updateStatus();
                }
            }

            // Function to trigger confetti
            function triggerCelebration() {
                const end = Date.now() + (1 * 1000); // 1 second of confetti
                const colors = ['#e54f6d', '#f8c630', '#724e91', '#451f55'];

                (function frame() {
                    confetti({
                        particleCount: 4,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: colors
                    });
                    confetti({
                        particleCount: 4,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: colors
                    });

                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                }());
            }

            function startGame() {
                gameMode = parseInt(modeSelector.value, 10);
                const size = parseInt(sizeSelector.value, 10);
                const shuffledSymbols = [...allSymbols];
                shuffle(shuffledSymbols);
                currentSymbolSet = shuffledSymbols.slice(0, size);
                createCards();
            }
            
            modeSelector.addEventListener('change', () => {
                // No need for logic here, it will be handled on Start New Game click
            });

            restartButton.addEventListener('click', startGame);

            // Start the game with the default settings
            startGame();
        });
    </script>
</body>
</html>